// ──────────────────────────────────────────────
// phases.ts — 5 фаз реабилитации после ORIF
// локтевого сустава (olecranon / radial head)
// ──────────────────────────────────────────────

export interface RecoveryPhase {
  number: number
  name: string
  startWeek: number
  endWeek: number
  goals: string[]
  romTarget: { min: number; max: number }
  restrictions: string[]
}

export const phases: RecoveryPhase[] = [
  // ───── Фаза 1: Ранняя мобилизация ─────
  {
    number: 1,
    name: 'Ранняя мобилизация',
    startWeek: 0,
    endWeek: 6,
    goals: [
      'Защита зоны операции, заживление мягких тканей',
      'Контроль отёка и боли',
      'Начало пассивных движений в безопасной амплитуде',
      'Поддержание подвижности кисти и плечевого сустава',
      'Достижение ROM 15–30° сгибания',
    ],
    romTarget: { min: 15, max: 30 },
    restrictions: [
      'Запрещены активные движения в локтевом суставе',
      'Запрещена нагрузка на оперированную руку',
      'Не поднимать предметы тяжелее 0.5 кг',
      'Носить ортез/лангету по предписанию хирурга',
      'Исключить ротационные движения предплечья',
      'Не опираться на руку',
    ],
  },

  // ───── Фаза 2: Активная разработка ─────
  {
    number: 2,
    name: 'Активная разработка',
    startWeek: 7,
    endWeek: 12,
    goals: [
      'Восстановление активного объёма движений',
      'Достижение ROM 60–80° сгибания',
      'Начало активных упражнений с ассистенцией',
      'Восстановление пронации/супинации',
      'Уменьшение контрактуры разгибания',
    ],
    romTarget: { min: 60, max: 80 },
    restrictions: [
      'Не поднимать предметы тяжелее 1 кг',
      'Запрещены резкие движения и рывки',
      'Запрещены силовые упражнения с сопротивлением',
      'Не висеть на руке / не делать подтягивания',
      'При боли выше 3/10 — прекратить упражнение',
    ],
  },

  // ───── Фаза 3: Силовая фаза ─────
  {
    number: 3,
    name: 'Силовая фаза',
    startWeek: 13,
    endWeek: 20,
    goals: [
      'Укрепление мышц плеча, предплечья и кисти',
      'Достижение ROM 80–100° сгибания',
      'Начало упражнений с лёгким сопротивлением',
      'Восстановление выносливости мышц',
      'Полное разгибание (дефицит не более 10–15°)',
    ],
    romTarget: { min: 80, max: 100 },
    restrictions: [
      'Нагрузка не более 2–3 кг',
      'Избегать упражнений, вызывающих боль в зоне пластины',
      'Постепенное увеличение нагрузки (не более 10% в неделю)',
      'Запрещены контактные виды спорта',
      'Запрещены упражнения на максимальное разгибание под нагрузкой',
    ],
  },

  // ───── Фаза 4: Функциональная фаза ─────
  {
    number: 4,
    name: 'Функциональная фаза',
    startWeek: 21,
    endWeek: 32,
    goals: [
      'Возврат к повседневной активности',
      'Достижение ROM 100–120° сгибания',
      'Полная пронация и супинация',
      'Способность поднимать 5–10 кг',
      'Восстановление бытовых навыков (вождение, готовка, уборка)',
    ],
    romTarget: { min: 100, max: 120 },
    restrictions: [
      'Избегать экстремальных нагрузок и ударных видов спорта',
      'Наращивать интенсивность постепенно',
      'При появлении отёка после нагрузки — снизить интенсивность',
      'Консультация хирурга перед возвращением к тяжёлому физическому труду',
    ],
  },

  // ───── Фаза 5: Оптимизация ─────
  {
    number: 5,
    name: 'Оптимизация',
    startWeek: 33,
    endWeek: 78,
    goals: [
      'Максимальное восстановление ROM (100–130° сгибания)',
      'Полная сила и выносливость',
      'Возврат к спортивной активности',
      'Адаптация к остаточным ограничениям (если есть)',
      'Решение об удалении металлоконструкции (12–18 месяцев)',
    ],
    romTarget: { min: 100, max: 130 },
    restrictions: [
      'Индивидуальные ограничения по рекомендации хирурга',
      'Избегать видов спорта с высоким риском падений на руку',
      'При наличии пластины — ограничение ударных нагрузок на локоть',
    ],
  },
]

export function getPhaseByNumber(num: number): RecoveryPhase | undefined {
  return phases.find((p) => p.number === num)
}

export function getPhaseByWeek(week: number): RecoveryPhase | undefined {
  return phases.find((p) => week >= p.startWeek && week <= p.endWeek)
}
